<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400" style="background: white;">
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#1e3a8a">
    HTLC Cascade: Three-Domain Flow
  </text>
  
  <!-- Domains -->
  <!-- Client A -->
  <rect x="50" y="60" width="150" height="280" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="125" y="85" text-anchor="middle" font-weight="bold" fill="#1e3a8a">Domain A (Client)</text>
  
  <!-- Gateway B -->
  <rect x="325" y="60" width="150" height="280" rx="10" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="400" y="85" text-anchor="middle" font-weight="bold" fill="#1e3a8a">Gateway B (E-NAT)</text>
  
  <!-- Provider C -->
  <rect x="600" y="60" width="150" height="280" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="675" y="85" text-anchor="middle" font-weight="bold" fill="#1e3a8a">Provider C</text>
  
  <!-- Phase 1: Query/Advert -->
  <text x="125" y="120" text-anchor="middle" font-size="12" fill="#374151">1. QUERY</text>
  <line x1="200" y1="125" x2="320" y2="125" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowblue)"/>
  
  <text x="400" y="140" text-anchor="middle" font-size="12" fill="#374151">QUERY fwd</text>
  <line x1="475" y1="145" x2="595" y2="145" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowblue)"/>
  
  <text x="675" y="160" text-anchor="middle" font-size="12" fill="#16a34a">2. ADVERT</text>
  <line x1="600" y1="165" x2="480" y2="165" stroke="#16a34a" stroke-width="2" marker-end="url(#arrowgreen)"/>
  
  <text x="400" y="180" text-anchor="middle" font-size="12" fill="#16a34a">ADVERT fwd</text>
  <line x1="325" y1="185" x2="205" y2="185" stroke="#16a34a" stroke-width="2" marker-end="url(#arrowgreen)"/>
  
  <!-- Phase 2: Select/Lock -->
  <text x="125" y="210" text-anchor="middle" font-size="12" fill="#dc2626">3. SELECT</text>
  <line x1="200" y1="215" x2="320" y2="215" stroke="#dc2626" stroke-width="2" marker-end="url(#arrowred)"/>
  <text x="260" y="210" text-anchor="middle" font-size="10" fill="#dc2626">$10.00</text>
  
  <text x="400" y="230" text-anchor="middle" font-size="12" fill="#dc2626">SELECT fwd</text>
  <line x1="475" y1="235" x2="595" y2="235" stroke="#dc2626" stroke-width="2" marker-end="url(#arrowred)"/>
  <text x="535" y="230" text-anchor="middle" font-size="10" fill="#dc2626">$9.50</text>
  
  <!-- HTLCs Locked -->
  <rect x="70" y="250" width="110" height="25" rx="5" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="125" y="267" text-anchor="middle" font-size="11" font-weight="bold" fill="#92400e">HTLC: $10</text>
  
  <rect x="345" y="250" width="110" height="25" rx="5" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="400" y="267" text-anchor="middle" font-size="11" font-weight="bold" fill="#92400e">HTLC: $9.50</text>
  
  <!-- Phase 3: Proof/Settle -->
  <text x="675" y="300" text-anchor="middle" font-size="12" fill="#7c3aed">4. PROOF</text>
  <line x1="600" y1="305" x2="480" y2="305" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowpurple)"/>
  <text x="540" y="300" text-anchor="middle" font-size="10" fill="#7c3aed">secret</text>
  
  <text x="400" y="320" text-anchor="middle" font-size="12" fill="#7c3aed">PROOF fwd</text>
  <line x1="325" y1="325" x2="205" y2="325" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowpurple)"/>
  <text x="265" y="320" text-anchor="middle" font-size="10" fill="#7c3aed">secret</text>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#3b82f6" />
    </marker>
    <marker id="arrowgreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#16a34a" />
    </marker>
    <marker id="arrowred" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#dc2626" />
    </marker>
    <marker id="arrowpurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#7c3aed" />
    </marker>
  </defs>
  
  <!-- Legend -->
  <text x="50" y="370" font-size="12" font-weight="bold" fill="#1e3a8a">Result:</text>
  <text x="120" y="370" font-size="11" fill="#374151">Client pays $10.00</text>
  <text x="260" y="370" font-size="11" fill="#374151">Gateway earns $0.50</text>
  <text x="410" y="370" font-size="11" fill="#374151">Provider earns $9.50</text>
  
  <text x="600" y="370" font-size="10" font-style="italic" fill="#6b7280">Atomic settlement âœ“</text>
</svg>
